package com.itome.githubmvi.ui.repository

import android.graphics.drawable.ColorDrawable
import android.support.design.widget.AppBarLayout
import android.support.design.widget.AppBarLayout.LayoutParams.SCROLL_FLAG_EXIT_UNTIL_COLLAPSED
import android.support.design.widget.AppBarLayout.LayoutParams.SCROLL_FLAG_SCROLL
import android.support.design.widget.CollapsingToolbarLayout
import android.support.design.widget.CollapsingToolbarLayout.LayoutParams.COLLAPSE_MODE_PARALLAX
import android.support.design.widget.CollapsingToolbarLayout.LayoutParams.COLLAPSE_MODE_PIN
import android.support.design.widget.FloatingActionButton
import android.support.v7.widget.Toolbar
import android.view.Gravity
import android.view.View
import android.widget.ImageView
import android.widget.TextView
import com.bumptech.glide.Glide
import com.bumptech.glide.request.RequestOptions
import com.itome.githubmvi.R
import com.itome.githubmvi.extensions.decodeMarkDown
import com.itome.githubmvi.extensions.getContextColor
import com.itome.githubmvi.extensions.getResourceId
import com.itome.githubmvi.ui.widget.circleImageView
import com.itome.githubmvi.ui.widget.markdownView
import jp.wasabeef.glide.transformations.BlurTransformation
import org.jetbrains.anko.*
import org.jetbrains.anko.appcompat.v7.toolbar
import org.jetbrains.anko.design.collapsingToolbarLayout
import org.jetbrains.anko.design.coordinatorLayout
import org.jetbrains.anko.design.floatingActionButton
import org.jetbrains.anko.design.themedAppBarLayout
import org.jetbrains.anko.support.v4.nestedScrollView
import ru.noties.markwon.Markwon
import ru.noties.markwon.view.MarkwonView

class RepositoryActivityUI : AnkoComponent<RepositoryActivity> {

    lateinit var toolbar: Toolbar
    private val fabAnchorId = View.generateViewId()
    private lateinit var watchCountTextView: TextView
    private lateinit var starCountTextView: TextView
    private lateinit var forkCountTextView: TextView
    private lateinit var fullNameTextView: TextView
    private lateinit var descriptionTextView: TextView
    private lateinit var headerImageView: ImageView
    private lateinit var userCircleImageView: ImageView
    private lateinit var markdownView: MarkwonView
    private lateinit var fab: FloatingActionButton

    fun applyState() {
        Glide.with(headerImageView.context)
                .load(R.drawable.ic_launcher_background)
                .apply(RequestOptions().placeholder(R.color.black))
                .apply(RequestOptions.bitmapTransform(BlurTransformation(100)))
                .into(headerImageView)
        watchCountTextView.text = "12"
        starCountTextView.text = "8"
        forkCountTextView.text = "100"
        fullNameTextView.text = "itome/smart-backspace"
        descriptionTextView.text = "hogehogehogehogehoghoehgoehogehogehogehogehogehogehogehogehgoehogehgoehogehgehoge"
        Markwon.setMarkdown(markdownView, "IyBPY3Rva2l0CgpSdWJ5IHRvb2xraXQgZm9yIHRoZSBHaXRIdWIgQVBJLgoK\nIVtsb2dvXShodHRwOi8vY2wubHkvaW1hZ2UvM1kwMTNIMEEyejN6L2d1bmRh\nbS1ydWJ5LnBuZykKClVwZ3JhZGluZz8gQ2hlY2sgdGhlIFtVcGdyYWRlIEd1\naWRlXSgjdXBncmFkaW5nLWd1aWRlKSBiZWZvcmUgYnVtcGluZyB0byBhIG5l\ndwpbbWFqb3IgdmVyc2lvbl1bc2VtdmVyXS4KCiMjIFRhYmxlIG9mIENvbnRl\nbnRzCgoxLiBbUGhpbG9zb3BoeV0oI3BoaWxvc29waHkpCjIuIFtRdWljayBz\ndGFydF0oI3F1aWNrLXN0YXJ0KQozLiBbTWFraW5nIHJlcXVlc3RzXSgjbWFr\naW5nLXJlcXVlc3RzKQo0LiBbQ29uc3VtaW5nIHJlc291cmNlc10oI2NvbnN1\nbWluZy1yZXNvdXJjZXMpCjUuIFtBY2Nlc3NpbmcgSFRUUCByZXNwb25zZXNd\nKCNhY2Nlc3NpbmctaHR0cC1yZXNwb25zZXMpCjYuIFtBdXRoZW50aWNhdGlv\nbl0oI2F1dGhlbnRpY2F0aW9uKQogICAxLiBbQmFzaWMgQXV0aGVudGljYXRp\nb25dKCNiYXNpYy1hdXRoZW50aWNhdGlvbikKICAgMi4gW09BdXRoIGFjY2Vz\ncyB0b2tlbnNdKCNvYXV0aC1hY2Nlc3MtdG9rZW5zKQogICAzLiBbVHdvLUZh\nY3RvciBBdXRoZW50aWNhdGlvbl0oI3R3by1mYWN0b3ItYXV0aGVudGljYXRp\nb24pCiAgIDQuIFtVc2luZyBhIC5uZXRyYyBmaWxlXSgjdXNpbmctYS1uZXRy\nYy1maWxlKQogICA1LiBbQXBwbGljYXRpb24gYXV0aGVudGljYXRpb25dKCNh\ncHBsaWNhdGlvbi1hdXRoZW50aWNhdGlvbikKNy4gW1BhZ2luYXRpb25dKCNw\nYWdpbmF0aW9uKQogICAxLiBbQXV0byBwYWdpbmF0aW9uXSgjYXV0by1wYWdp\nbmF0aW9uKQo4LiBbV29ya2luZyB3aXRoIEdpdEh1YiBFbnRlcnByaXNlXSgj\nd29ya2luZy13aXRoLWdpdGh1Yi1lbnRlcnByaXNlKQogICAxLiBbSW50ZXJh\nY3Rpbmcgd2l0aCB0aGUgR2l0SHViLmNvbSBBUElzIGluIEdpdEh1YiBFbnRl\ncnByaXNlXSgjaW50ZXJhY3Rpbmctd2l0aC10aGUtZ2l0aHViY29tLWFwaXMt\naW4tZ2l0aHViLWVudGVycHJpc2UpCiAgIDIuIFtJbnRlcmFjdGluZyB3aXRo\nIHRoZSBHaXRIdWIgRW50ZXJwcmlzZSBBZG1pbiBBUElzXSgjaW50ZXJhY3Rp\nbmctd2l0aC10aGUtZ2l0aHViLWVudGVycHJpc2UtYWRtaW4tYXBpcykKICAg\nMy4gW0ludGVyYWN0aW5nIHdpdGggdGhlIEdpdEh1YiBFbnRlcnByaXNlIE1h\nbmFnZW1lbnQgQ29uc29sZSBBUElzXSgjaW50ZXJhY3Rpbmctd2l0aC10aGUt\nZ2l0aHViLWVudGVycHJpc2UtbWFuYWdlbWVudC1jb25zb2xlLWFwaXMpCjku\nIFtTU0wgQ29ubmVjdGlvbiBFcnJvcnNdKCNzc2wtY29ubmVjdGlvbi1lcnJv\ncnMpCjEwLiBbQ29uZmlndXJhdGlvbiBhbmQgZGVmYXVsdHNdKCNjb25maWd1\ncmF0aW9uLWFuZC1kZWZhdWx0cykKICAgIDEuIFtDb25maWd1cmluZyBtb2R1\nbGUgZGVmYXVsdHNdKCNjb25maWd1cmluZy1tb2R1bGUtZGVmYXVsdHMpCiAg\nICAyLiBbVXNpbmcgRU5WIHZhcmlhYmxlc10oI3VzaW5nLWVudi12YXJpYWJs\nZXMpCjExLiBbSHlwZXJtZWRpYSBhZ2VudF0oI2h5cGVybWVkaWEtYWdlbnQp\nCiAgICAxLiBbSHlwZXJtZWRpYSBpbiBPY3Rva2l0XSgjaHlwZXJtZWRpYS1p\nbi1vY3Rva2l0KQogICAgMi4gW1VSSSB0ZW1wbGF0ZXNdKCN1cmktdGVtcGxh\ndGVzKQogICAgMy4gW1RoZSBGdWxsIEh5cGVybWVkaWEgRXhwZXJpZW5jZeKE\nol0oI3RoZS1mdWxsLWh5cGVybWVkaWEtZXhwZXJpZW5jZSkKMTIuIFtVcGdy\nYWRpbmcgZ3VpZGVdKCN1cGdyYWRpbmctZ3VpZGUpCiAgICAxLiBbVXBncmFk\naW5nIGZyb20gMS54LnhdKCN1cGdyYWRpbmctZnJvbS0xeHgpCjEzLiBbQWR2\nYW5jZWQgdXNhZ2VdKCNhZHZhbmNlZC11c2FnZSkKICAgIDEuIFtEZWJ1Z2dp\nbmddKCNkZWJ1Z2dpbmcpCiAgICAyLiBbQ2FjaGluZ10oI2NhY2hpbmcpCjE0\nLiBbSGFja2luZyBvbiBPY3Rva2l0LnJiXSgjaGFja2luZy1vbi1vY3Rva2l0\ncmIpCiAgICAxLiBbUnVubmluZyBhbmQgd3JpdGluZyBuZXcgdGVzdHNdKCNy\ndW5uaW5nLWFuZC13cml0aW5nLW5ldy10ZXN0cykKMTUuIFtTdXBwb3J0ZWQg\nUnVieSBWZXJzaW9uc10oI3N1cHBvcnRlZC1ydWJ5LXZlcnNpb25zKQoxNi4g\nW1ZlcnNpb25pbmddKCN2ZXJzaW9uaW5nKQoxNy4gW0xpY2Vuc2VdKCNsaWNl\nbnNlKQoKIyMgUGhpbG9zb3BoeQoKQVBJIHdyYXBwZXJzIFtzaG91bGQgcmVm\nbGVjdCB0aGUgaWRpb21zIG9mIHRoZSBsYW5ndWFnZSBpbiB3aGljaCB0aGV5\nIHdlcmUKd3JpdHRlbl1bd3JhcHBlcnNdLiBPY3Rva2l0LnJiIHdyYXBzIHRo\nZSBbR2l0SHViIEFQSV1bZ2l0aHViLWFwaV0gaW4gYSBmbGF0IEFQSQpjbGll\nbnQgdGhhdCBmb2xsb3dzIFJ1YnkgY29udmVudGlvbnMgYW5kIHJlcXVpcmVz\nIGxpdHRsZSBrbm93bGVkZ2Ugb2YgUkVTVC4KTW9zdCBtZXRob2RzIGhhdmUg\ncG9zaXRpb25hbCBhcmd1bWVudHMgZm9yIHJlcXVpcmVkIGlucHV0IGFuZCBh\nbiBvcHRpb25zIGhhc2gKZm9yIG9wdGlvbmFsIHBhcmFtZXRlcnMsIGhlYWRl\ncnMsIG9yIG90aGVyIG9wdGlvbnM6CgpgYGBydWJ5CiMgRmV0Y2ggYSBSRUFE\nTUUgd2l0aCBBY2NlcHQgaGVhZGVyIGZvciBIVE1MIGZvcm1hdApPY3Rva2l0\nLnJlYWRtZSAnYWwzeC9zb3ZlcmVpZ24nLCA6YWNjZXB0ID0+ICdhcHBsaWNh\ndGlvbi92bmQuZ2l0aHViLmh0bWwnCmBgYAoKClt3cmFwcGVyc106IGh0dHA6\nLy93eW5ubmV0aGVybGFuZC5jb20vam91cm5hbC93aGF0LW1ha2VzLWEtZ29v\nZC1hcGktd3JhcHBlcgpbZ2l0aHViLWFwaV06IGh0dHA6Ly9kZXZlbG9wZXIu\nZ2l0aHViLmNvbQoKIyMgUXVpY2sgc3RhcnQKCkluc3RhbGwgdmlhIFJ1Ynln\nZW1zCgogICAgZ2VtIGluc3RhbGwgb2N0b2tpdAoKLi4uIG9yIGFkZCB0byB5\nb3VyIEdlbWZpbGUKCiAgICBnZW0gIm9jdG9raXQiLCAifj4gNC4wIgoKIyMj\nIE1ha2luZyByZXF1ZXN0cwoKW0FQSSBtZXRob2RzXVtdIGFyZSBhdmFpbGFi\nbGUgYXMgbW9kdWxlIG1ldGhvZHMgKGNvbnN1bWluZyBtb2R1bGUtbGV2ZWwK\nY29uZmlndXJhdGlvbikgb3IgYXMgY2xpZW50IGluc3RhbmNlIG1ldGhvZHMu\nCgpgYGBydWJ5CiMgUHJvdmlkZSBhdXRoZW50aWNhdGlvbiBjcmVkZW50aWFs\ncwpPY3Rva2l0LmNvbmZpZ3VyZSBkbyB8Y3wKICBjLmxvZ2luID0gJ2RlZnVu\na3QnCiAgYy5wYXNzd29yZCA9ICdjMGQzYjRzc3Nzc3MhJwplbmQKCiMgRmV0\nY2ggdGhlIGN1cnJlbnQgdXNlcgpPY3Rva2l0LnVzZXIKYGBgCm9yCgpgYGBy\ndWJ5CiMgUHJvdmlkZSBhdXRoZW50aWNhdGlvbiBjcmVkZW50aWFscwpjbGll\nbnQgPSBPY3Rva2l0OjpDbGllbnQubmV3KDpsb2dpbiA9PiAnZGVmdW5rdCcs\nIDpwYXNzd29yZCA9PiAnYzBkM2I0c3Nzc3NzIScpCiMgRmV0Y2ggdGhlIGN1\ncnJlbnQgdXNlcgpjbGllbnQudXNlcgpgYGAKCiMjIyBBZGRpdGlvbmFsIFF1\nZXJ5IFBhcmFtZXRlcnMKCldoZW4gcGFzc2luZyBhZGRpdGlvbmFsIHBhcmFt\nZXRlcnMgdG8gR0VUIGJhc2VkIHJlcXVlc3QgdXNlIHRoZSBmb2xsb3dpbmcg\nc3ludGF4OgoKYGBgcnVieQogIyBxdWVyeTogeyBwYXJhbWV0ZXJfbmFtZTog\nJ3ZhbHVlJyB9CiAjIEV4YW1wbGU6IEdldCByZXBvc2l0b3J5IGxpc3Rpbmcg\nYnkgb3duZXIgaW4gYXNjZW5kaW5nIG9yZGVyCiBjbGllbnQucmVwb3Moe30s\nIHF1ZXJ5OiB7dHlwZTogJ293bmVyJywgc29ydDogJ2FzYyd9KQoKICMgRXhh\nbXBsZTogR2V0IGNvbnRlbnRzIG9mIGEgcmVwb3NpdG9yeSBieSByZWYKICMg\naHR0cHM6Ly9hcGkuZ2l0aHViLmNvbS9yZXBvcy9vY3Rva2l0L29jdG9raXQu\ncmIvY29udGVudHMvcGF0aC90by9maWxlLnJiP3JlZj1zb21lLW90aGVyLWJy\nYW5jaAogY2xpZW50LmNvbnRlbnRzKCdvY3Rva2l0L29jdG9raXQucmInLCBw\nYXRoOiAncGF0aC90by9maWxlLnJiJywgcXVlcnk6IHtyZWY6ICdzb21lLW90\naGVyLWJyYW5jaCd9KQoKYGBgCgpbQVBJIG1ldGhvZHNdOiBodHRwOi8vb2N0\nb2tpdC5naXRodWIuaW8vb2N0b2tpdC5yYi9tZXRob2RfbGlzdC5odG1sCgoj\nIyMgQ29uc3VtaW5nIHJlc291cmNlcwoKTW9zdCBtZXRob2RzIHJldHVybiBh\nIGBSZXNvdXJjZWAgb2JqZWN0IHdoaWNoIHByb3ZpZGVzIGRvdCBub3RhdGlv\nbiBhbmQgYFtdYAphY2Nlc3MgZm9yIGZpZWxkcyByZXR1cm5lZCBpbiB0aGUg\nQVBJIHJlc3BvbnNlLgoKYGBgcnVieQojIEZldGNoIGEgdXNlcgp1c2VyID0g\nT2N0b2tpdC51c2VyICdqYmFybmV0dGUnCnB1dHMgdXNlci5uYW1lCiMgPT4g\nIkpvaG4gQmFybmV0dGUiCnB1dHMgdXNlci5maWVsZHMKIyA9PiA8U2V0OiB7\nOmxvZ2luLCA6aWQsIDpncmF2YXRhcl9pZCwgOnR5cGUsIDpuYW1lLCA6Y29t\ncGFueSwgOmJsb2csIDpsb2NhdGlvbiwgOmVtYWlsLCA6aGlyZWFibGUsIDpi\naW8sIDpwdWJsaWNfcmVwb3MsIDpmb2xsb3dlcnMsIDpmb2xsb3dpbmcsIDpj\ncmVhdGVkX2F0LCA6dXBkYXRlZF9hdCwgOnB1YmxpY19naXN0c30+CnB1dHMg\ndXNlcls6Y29tcGFueV0KIyA9PiAiR2l0SHViIgp1c2VyLnJlbHNbOmdpc3Rz\nXS5ocmVmCiMgPT4gImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlcnMvamJh\ncm5ldHRlL2dpc3RzIgpgYGAKCioqTm90ZToqKiBVUkwgZmllbGRzIGFyZSBj\ndWxsZWQgaW50byBhIHNlcGFyYXRlIGAucmVsc2AgY29sbGVjdGlvbiBmb3Ig\nZWFzaWVyCltIeXBlcm1lZGlhXSgjaHlwZXJtZWRpYS1hZ2VudCkgc3VwcG9y\ndC4KCiMjIyBBY2Nlc3NpbmcgSFRUUCByZXNwb25zZXMKCldoaWxlIG1vc3Qg\nbWV0aG9kcyByZXR1cm4gYSBgUmVzb3VyY2VgIG9iamVjdCBvciBhIEJvb2xl\nYW4sIHNvbWV0aW1lcyB5b3UgbWF5Cm5lZWQgYWNjZXNzIHRvIHRoZSByYXcg\nSFRUUCByZXNwb25zZSBoZWFkZXJzLiBZb3UgY2FuIGFjY2VzcyB0aGUgbGFz\ndCBIVFRQCnJlc3BvbnNlIHdpdGggYENsaWVudCNsYXN0X3Jlc3BvbnNlYDoK\nCmBgYHJ1YnkKdXNlciAgICAgID0gT2N0b2tpdC51c2VyICdhbmRyZXdwdGhv\ncnAnCnJlc3BvbnNlICA9IE9jdG9raXQubGFzdF9yZXNwb25zZQpldGFnICAg\nICAgPSByZXNwb25zZS5oZWFkZXJzWzpldGFnXQpgYGAKCiMjIEF1dGhlbnRp\nY2F0aW9uCgpPY3Rva2l0IHN1cHBvcnRzIHRoZSB2YXJpb3VzIFthdXRoZW50\naWNhdGlvbiBtZXRob2RzIHN1cHBvcnRlZCBieSB0aGUgR2l0SHViCkFQSV1b\nYXV0aF06CgojIyMgQmFzaWMgQXV0aGVudGljYXRpb24KClVzaW5nIHlvdXIg\nR2l0SHViIHVzZXJuYW1lIGFuZCBwYXNzd29yZCBpcyB0aGUgZWFzaWVzdCB3\nYXkgdG8gZ2V0IHN0YXJ0ZWQKbWFraW5nIGF1dGhlbnRpY2F0ZWQgcmVxdWVz\ndHM6CgpgYGBydWJ5CmNsaWVudCA9IE9jdG9raXQ6OkNsaWVudC5uZXcgXAog\nIDpsb2dpbiAgICA9PiAnZGVmdW5rdCcsCiAgOnBhc3N3b3JkID0+ICdjMGQz\nYjRzc3Nzc3MhJwoKdXNlciA9IGNsaWVudC51c2VyCnVzZXIubG9naW4KIyA9\nPiAiZGVmdW5rdCIKYGBgCldoaWxlIEJhc2ljIEF1dGhlbnRpY2F0aW9uIGFs\nbG93cyB5b3UgdG8gZ2V0IHN0YXJ0ZWQgcXVpY2tseSwgT0F1dGggYWNjZXNz\nCnRva2VucyBhcmUgdGhlIHByZWZlcnJlZCB3YXkgdG8gYXV0aGVudGljYXRl\nIG9uIGJlaGFsZiBvZiB1c2Vycy4KCiMjIyBPQXV0aCBhY2Nlc3MgdG9rZW5z\nCgpbT0F1dGggYWNjZXNzIHRva2Vuc11bb2F1dGhdIHByb3ZpZGUgdHdvIG1h\naW4gYmVuZWZpdHMgb3ZlciB1c2luZyB5b3VyIHVzZXJuYW1lCmFuZCBwYXNz\nd29yZDoKCiogKipSZXZva2FibGUgYWNjZXNzKiouIEFjY2VzcyB0b2tlbnMg\nY2FuIGJlIHJldm9rZWQsIHJlbW92aW5nIGFjY2VzcyBmb3Igb25seQogIHRo\nYXQgdG9rZW4gd2l0aG91dCBoYXZpbmcgdG8gY2hhbmdlIHlvdXIgcGFzc3dv\ncmQgZXZlcnl3aGVyZS4KKiAqKkxpbWl0ZWQgYWNjZXNzKiouIEFjY2VzcyB0\nb2tlbnMgaGF2ZSBbYWNjZXNzIHNjb3Blc11bXSB3aGljaCBhbGxvdyBmb3Ig\nbW9yZQogIGdyYW51bGFyIGFjY2VzcyB0byBBUEkgcmVzb3VyY2VzLiBGb3Ig\naW5zdGFuY2UsIHlvdSBjYW4gZ3JhbnQgYSB0aGlyZCBwYXJ0eQogIGFjY2Vz\ncyB0byB5b3VyIGdpc3RzIGJ1dCBub3QgeW91ciBwcml2YXRlIHJlcG9zaXRv\ncmllcy4KClRvIHVzZSBhbiBhY2Nlc3MgdG9rZW4gd2l0aCB0aGUgT2N0b2tp\ndCBjbGllbnQsIHBhc3MgeW91ciB0b2tlbiBpbiB0aGUKYDphY2Nlc3NfdG9r\nZW5gIG9wdGlvbnMgcGFyYW1ldGVyIGluIGxpZXUgb2YgeW91ciB1c2VybmFt\nZSBhbmQgcGFzc3dvcmQ6CgpgYGBydWJ5CmNsaWVudCA9IE9jdG9raXQ6OkNs\naWVudC5uZXcoOmFjY2Vzc190b2tlbiA9PiAiPHlvdXIgNDAgY2hhciB0b2tl\nbj4iKQoKdXNlciA9IGNsaWVudC51c2VyCnVzZXIubG9naW4KIyA9PiAiZGVm\ndW5rdCIKYGBgCgpZb3UgY2FuIFtjcmVhdGUgYWNjZXNzIHRva2VucyB0aHJv\ndWdoIHlvdXIgR2l0SHViIEFjY291bnQgU2V0dGluZ3NdKGh0dHBzOi8vaGVs\ncC5naXRodWIuY29tL2FydGljbGVzL2NyZWF0aW5nLWFuLWFjY2Vzcy10b2tl\nbi1mb3ItY29tbWFuZC1saW5lLXVzZSkKb3Igd2l0aCBhIGJhc2ljIGF1dGhl\nbnRpY2F0ZWQgT2N0b2tpdCBjbGllbnQ6CgpgYGBydWJ5CmNsaWVudCA9IE9j\ndG9raXQ6OkNsaWVudC5uZXcgXAogIDpsb2dpbiAgICA9PiAnZGVmdW5rdCcs\nCiAgOnBhc3N3b3JkID0+ICdjMGQzYjRzc3Nzc3MhJwoKY2xpZW50LmNyZWF0\nZV9hdXRob3JpemF0aW9uKDpzY29wZXMgPT4gWyJ1c2VyIl0sIDpub3RlID0+\nICJOYW1lIG9mIHRva2VuIikKIyA9PiA8eW91ciBuZXcgb2F1dGggdG9rZW4+\nCmBgYAoKIyMjIFR3by1GYWN0b3IgQXV0aGVudGljYXRpb24KCltUd28tRmFj\ndG9yIEF1dGhlbnRpY2F0aW9uXShodHRwczovL2hlbHAuZ2l0aHViLmNvbS9h\ncnRpY2xlcy9hYm91dC10d28tZmFjdG9yLWF1dGhlbnRpY2F0aW9uKSBicmlu\nZ3MgYWRkZWQgc2VjdXJpdHkgdG8gdGhlIGFjY291bnQgYnkgcmVxdWlyaW5n\nIG1vcmUgaW5mb3JtYXRpb24gdG8gbG9naW4uCgpVc2luZyB0d28tZmFjdG9y\nIGF1dGhlbnRpY2F0aW9uIGZvciBBUEkgY2FsbHMgaXMgYXMgc2ltcGxlIGFz\nIGFkZGluZyB0aGUgW3JlcXVpcmVkIGhlYWRlcl0oaHR0cDovL2RldmVsb3Bl\nci5naXRodWIuY29tL3YzL2F1dGgvI3dvcmtpbmctd2l0aC10d28tZmFjdG9y\nLWF1dGhlbnRpY2F0aW9uKSBhcyBhbiBvcHRpb246CgpgYGBydWJ5CmNsaWVu\ndCA9IE9jdG9raXQ6OkNsaWVudC5uZXcgXAogIDpsb2dpbiAgICA9PiAnZGVm\ndW5rdCcsCiAgOnBhc3N3b3JkID0+ICdjMGQzYjRzc3Nzc3MhJwoKdXNlciA9\nIGNsaWVudC51c2VyKCJkZWZ1bmt0IiwgOmhlYWRlcnMgPT4geyAiWC1HaXRI\ndWItT1RQIiA9PiAiPHlvdXIgMkZBIHRva2VuPiIgfSkKYGBgCgpBcyB5b3Ug\nY2FuIGltYWdpbmUsIHRoaXMgZ2V0cyBhbm5veWluZyBxdWljayBzaW5jZSB0\nd28tZmFjdG9yIGF1dGggdG9rZW5zIGFyZSB2ZXJ5IHNob3J0IGxpdmVkLiBT\nbyBpdCBpcyByZWNvbW1lbmRlZCB0byBjcmVhdGUgYW4gb2F1dGggdG9rZW4g\nZm9yIHRoZSB1c2VyIHRvIGNvbW11bmljYXRlIHdpdGggdGhlIEFQSToKCmBg\nYHJ1YnkKY2xpZW50ID0gT2N0b2tpdDo6Q2xpZW50Lm5ldyBcCiAgOmxvZ2lu\nICAgID0+ICdkZWZ1bmt0JywKICA6cGFzc3dvcmQgPT4gJ2MwZDNiNHNzc3Nz\ncyEnCgpjbGllbnQuY3JlYXRlX2F1dGhvcml6YXRpb24oOnNjb3BlcyA9PiBb\nInVzZXIiXSwgOm5vdGUgPT4gIk5hbWUgb2YgdG9rZW4iLAogICAgICAgICAg\nICAgICAgICAgICAgICAgICAgOmhlYWRlcnMgPT4geyAiWC1HaXRIdWItT1RQ\nIiA9PiAiPHlvdXIgMkZBIHRva2VuPiIgfSkKIyA9PiA8eW91ciBuZXcgb2F1\ndGggdG9rZW4+CmBgYAoKIyMjIFVzaW5nIGEgLm5ldHJjIGZpbGUKCk9jdG9r\naXQgc3VwcG9ydHMgcmVhZGluZyBjcmVkZW50aWFscyBmcm9tIGEgbmV0cmMg\nZmlsZSAoZGVmYXVsdGluZyB0bwpgfi8ubmV0cmNgKS4gIEdpdmVuIHRoZXNl\nIGxpbmVzIGluIHlvdXIgbmV0cmM6CgpgYGAKbWFjaGluZSBhcGkuZ2l0aHVi\nLmNvbQogIGxvZ2luIGRlZnVua3QKICBwYXNzd29yZCBjMGQzYjRzc3Nzc3Mh\nCmBgYApZb3UgY2FuIG5vdyBjcmVhdGUgYSBjbGllbnQgd2l0aCB0aG9zZSBj\ncmVkZW50aWFsczoKCmBgYHJ1YnkKY2xpZW50ID0gT2N0b2tpdDo6Q2xpZW50\nLm5ldyg6bmV0cmMgPT4gdHJ1ZSkKY2xpZW50LmxvZ2luCiMgPT4gImRlZnVu\na3QiCmBgYApCdXQgX0kgd2FudCB0byB1c2UgT0F1dGhfIHlvdSBzYXkuIFNp\nbmNlIHRoZSBHaXRIdWIgQVBJIHN1cHBvcnRzIHVzaW5nIGFuIE9BdXRoCnRv\na2VuIGFzIGEgQmFzaWMgcGFzc3dvcmQsIHlvdSB0b3RhbGx5IGNhbjoKCmBg\nYAptYWNoaW5lIGFwaS5naXRodWIuY29tCiAgbG9naW4gZGVmdW5rdAogIHBh\nc3N3b3JkIDx5b3VyIDQwIGNoYXIgdG9rZW4+CmBgYAoKKipOb3RlOioqIFN1\ncHBvcnQgZm9yIG5ldHJjIHJlcXVpcmVzIGFkZGluZyB0aGUgW25ldHJjIGdl\nbV1bXSB0byB5b3VyIEdlbWZpbGUKb3IgYC5nZW1zcGVjYC4KCiMjIyBBcHBs\naWNhdGlvbiBhdXRoZW50aWNhdGlvbgoKT2N0b2tpdCBhbHNvIHN1cHBvcnRz\nIGFwcGxpY2F0aW9uLW9ubHkgYXV0aGVudGljYXRpb24gW3VzaW5nIE9BdXRo\nIGFwcGxpY2F0aW9uIGNsaWVudApjcmVkZW50aWFsc11bYXBwLWNyZWRzXS4g\nVXNpbmcgYXBwbGljYXRpb24gY3JlZGVudGlhbHMgd2lsbCByZXN1bHQgaW4g\nbWFraW5nCmFub255bW91cyBBUEkgY2FsbHMgb24gYmVoYWxmIG9mIGFuIGFw\ncGxpY2F0aW9uIGluIG9yZGVyIHRvIHRha2UgYWR2YW50YWdlIG9mCnRoZSBo\naWdoZXIgcmF0ZSBsaW1pdC4KCmBgYHJ1YnkKY2xpZW50ID0gT2N0b2tpdDo6\nQ2xpZW50Lm5ldyBcCiAgOmNsaWVudF9pZCAgICAgPT4gIjx5b3VyIDIwIGNo\nYXIgaWQ+IiwKICA6Y2xpZW50X3NlY3JldCA9PiAiPHlvdXIgNDAgY2hhciBz\nZWNyZXQ+IgoKdXNlciA9IGNsaWVudC51c2VyICdkZWZ1bmt0JwpgYGAKClth\ndXRoXTogaHR0cDovL2RldmVsb3Blci5naXRodWIuY29tL3YzLyNhdXRoZW50\naWNhdGlvbgpbb2F1dGhdOiBodHRwOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20v\ndjMvb2F1dGgvClthY2Nlc3Mgc2NvcGVzXTogaHR0cDovL2RldmVsb3Blci5n\naXRodWIuY29tL3YzL29hdXRoLyNzY29wZXMKW2FwcC1jcmVkc106IGh0dHA6\nLy9kZXZlbG9wZXIuZ2l0aHViLmNvbS92My8jaW5jcmVhc2luZy10aGUtdW5h\ndXRoZW50aWNhdGVkLXJhdGUtbGltaXQtZm9yLW9hdXRoLWFwcGxpY2F0aW9u\ncwoKIyMgRGVmYXVsdCByZXN1bHRzIHBlcl9wYWdlCgpEZWZhdWx0IHJlc3Vs\ndHMgZnJvbSB0aGUgR2l0SHViIEFQSSBhcmUgMzAsIGlmIHlvdSB3aXNoIHRv\nIGFkZCBtb3JlIHlvdSBtdXN0IGRvIHNvIGR1cmluZyBPY3Rva2l0IGNvbmZp\nZ3VyYXRpb24uCgpgYGBydWJ5CiAgT2N0b2tpdDo6Q2xpZW50Lm5ldyhhY2Nl\nc3NfdG9rZW46ICI8eW91ciA0MCBjaGFyIHRva2VuPiIsIHBlcl9wYWdlOiAx\nMDApCmBgYAoKIyMgUGFnaW5hdGlvbgoKTWFueSBHaXRIdWIgQVBJIHJlc291\ncmNlcyBhcmUgW3BhZ2luYXRlZF1bXS4gV2hpbGUgeW91IG1heSBiZSB0ZW1w\ndGVkIHRvIHN0YXJ0CmFkZGluZyBgOnBhZ2VgIHBhcmFtZXRlcnMgdG8geW91\nciBjYWxscywgdGhlIEFQSSByZXR1cm5zIGxpbmtzIHRvIHRoZSBuZXh0LApw\ncmV2aW91cywgYW5kIGxhc3QgcGFnZXMgZm9yIHlvdSBpbiB0aGUgYExpbmtg\nIHJlc3BvbnNlIGhlYWRlciBhcyBbSHlwZXJtZWRpYQpsaW5rIHJlbGF0aW9u\nc10oI2h5cGVybWVkaWEtYWdlbnQpLgoKYGBgcnVieQppc3N1ZXMgPSBPY3Rv\na2l0Lmlzc3VlcyAncmFpbHMvcmFpbHMnCmlzc3Vlcy5jb25jYXQgT2N0b2tp\ndC5sYXN0X3Jlc3BvbnNlLnJlbHNbOm5leHRdLmdldC5kYXRhCmBgYAoKIyMj\nIEF1dG8gcGFnaW5hdGlvbgoKRm9yIHNtYWxsaXNoIHJlc291cmNlIGxpc3Rz\nLCBPY3Rva2l0IHByb3ZpZGVzIGF1dG8gcGFnaW5hdGlvbi4gV2hlbiB0aGlz\nIGlzCmVuYWJsZWQsIGNhbGxzIGZvciBwYWdpbmF0ZWQgcmVzb3VyY2VzIHdp\nbGwgZmV0Y2ggYW5kIGNvbmNhdGVuYXRlIHRoZSByZXN1bHRzCmZyb20gZXZl\ncnkgcGFnZSBpbnRvIGEgc2luZ2xlIGFycmF5OgoKYGBgcnVieQpPY3Rva2l0\nLmF1dG9fcGFnaW5hdGUgPSB0cnVlCmlzc3VlcyA9IE9jdG9raXQuaXNzdWVz\nICdyYWlscy9yYWlscycKaXNzdWVzLmxlbmd0aAoKIyA9PiA3MDIKYGBgCgoq\nKk5vdGU6KiogV2hpbGUgT2N0b2tpdCBhdXRvIHBhZ2luYXRpb24gd2lsbCBz\nZXQgdGhlIHBhZ2Ugc2l6ZSB0byB0aGUgbWF4aW11bQpgMTAwYCwgYW5kIHNl\nZWsgdG8gbm90IG92ZXJzdGVwIHlvdXIgcmF0ZSBsaW1pdCwgeW91IHByb2Jh\nYmx5IHdhbnQgdG8gdXNlIGEKY3VzdG9tIHBhdHRlcm4gZm9yIHRyYXZlcnNp\nbmcgbGFyZ2UgbGlzdHMuCgpbcGFnaW5hdGVkXTogaHR0cDovL2RldmVsb3Bl\nci5naXRodWIuY29tL3YzLyNwYWdpbmF0aW9uCgojIyBXb3JraW5nIHdpdGgg\nR2l0SHViIEVudGVycHJpc2UKCldpdGggYSBiaXQgb2Ygc2V0dXAsIHlvdSBj\nYW4gYWxzbyB1c2UgT2N0b2tpdCB3aXRoIHlvdXIgR2l0aHViIEVudGVycHJp\nc2UgaW5zdGFuY2UuCgojIyMgSW50ZXJhY3Rpbmcgd2l0aCB0aGUgR2l0SHVi\nLmNvbSBBUElzIGluIEdpdEh1YiBFbnRlcnByaXNlCgpUbyBpbnRlcmFjdCB3\naXRoIHRoZSAicmVndWxhciIgR2l0SHViLmNvbSBBUElzIGluIEdpdEh1YiBF\nbnRlcnByaXNlLCBzaW1wbHkgY29uZmlndXJlIHRoZSBgYXBpX2VuZHBvaW50\nYCB0byBtYXRjaCB5b3VyIGhvc3RuYW1lLiBGb3IgZXhhbXBsZToKCmBgYCBy\ndWJ5Ck9jdG9raXQuY29uZmlndXJlIGRvIHxjfAogIGMuYXBpX2VuZHBvaW50\nID0gImh0dHBzOi8vPGhvc3RuYW1lPi9hcGkvdjMvIgplbmQKY2xpZW50ID0g\nT2N0b2tpdDo6Q2xpZW50Lm5ldyg6YWNjZXNzX3Rva2VuID0+ICI8eW91ciA0\nMCBjaGFyIHRva2VuPiIpCmBgYAoKIyMjIEludGVyYWN0aW5nIHdpdGggdGhl\nIEdpdEh1YiBFbnRlcnByaXNlIEFkbWluIEFQSXMKClRoZSBHaXRIdWIgRW50\nZXJwcmlzZSBBZG1pbiBBUElzIGFyZSB1bmRlciBhIGRpZmZlcmVudCBjbGll\nbnQ6IGBFbnRlcnByaXNlQWRtaW5DbGllbnRgLiBZb3UnbGwgbmVlZCB0byBo\nYXZlIGFuIGFkbWluaXN0cmF0b3IgYWNjb3VudCBpbiBvcmRlciB0byB1c2Ug\ndGhlc2UgQVBJcy4KCmBgYCBydWJ5CmFkbWluX2NsaWVudCA9IE9jdG9raXQ6\nOkVudGVycHJpc2VBZG1pbkNsaWVudC5uZXcgXAogICAgICAgICAgICAgICAg\nICAgICAgICAgIDphY2Nlc3NfdG9rZW4gPT4gIjx5b3VyIDQwIGNoYXIgdG9r\nZW4+IiwKICAgICAgICAgICAgICAgICAgICAgICAgICA6YXBpX2VuZHBvaW50\nID0+ICJodHRwczovLzxob3N0bmFtZT4vYXBpL3YzLyIKCiMgb3IKT2N0b2tp\ndC5jb25maWd1cmUgZG8gfGN8CiAgYy5hcGlfZW5kcG9pbnQgPSAiaHR0cHM6\nLy88aG9zdG5hbWU+L2FwaS92My8iCiAgYy5hY2Nlc3NfdG9rZW4gPSAiPHlv\ndXIgNDAgY2hhciB0b2tlbj4iCmVuZAphZG1pbl9jbGllbnQgPSBPY3Rva2l0\nLmVudGVycHJpc2VfYWRtaW5fY2xpZW50CmBgYAoKIyMjIEludGVyYWN0aW5n\nIHdpdGggdGhlIEdpdEh1YiBFbnRlcnByaXNlIE1hbmFnZW1lbnQgQ29uc29s\nZSBBUElzCgpUaGUgR2l0SHViIEVudGVycHJpc2UgTWFuYWdlbWVudCBDb25z\nb2xlIEFQSXMgYXJlIGFsc28gdW5kZXIgYSBzZXBhcmF0ZSBjbGllbnQ6IGBF\nbnRlcnByaXNlTWFuYWdlbWVudENvbnNvbGVDbGllbnRgLiBJbiBvcmRlciB0\nbyB1c2UgaXQsIHlvdSdsbCBuZWVkIHRvIHByb3ZpZGUgYm90aCB5b3VyIG1h\nbmFnZW1lbnQgY29uc29sZSBwYXNzd29yZCBhcyB3ZWxsIGFzIHRoZSBlbmRw\nb2ludCB0byB5b3VyIG1hbmFnZW1lbnQgY29uc29sZS4gVGhpcyBpcyBkaWZm\nZXJlbnQgdGhhbiB0aGUgQVBJIGVuZHBvaW50IHByb3ZpZGVkIGFib3ZlLgoK\nYGBgIHJ1YnkKbWFuYWdlbWVudF9jb25zb2xlX2NsaWVudCA9IE9jdG9raXQ6\nOkVudGVycHJpc2VNYW5hZ2VtZW50Q29uc29sZUNsaWVudC5uZXcgXAogICAg\nICAgICAgICAgICAgICAgICAgICAgIDptYW5hZ2VtZW50X2NvbnNvbGVfcGFz\nc3dvcmQgPT4gInNlY3JldCIsCiAgICAgICAgICAgICAgICAgICAgICAgICAg\nOm1hbmFnZW1lbnRfY29uc29sZV9lbmRwb2ludCA9ICJodHRwczovL2hvc3Ru\nYW1lOjg2MzMiCiMgb3IKT2N0b2tpdC5jb25maWd1cmUgZG8gfGN8CiAgYy5t\nYW5hZ2VtZW50X2NvbnNvbGVfZW5kcG9pbnQgPSAiaHR0cHM6Ly9ob3N0bmFt\nZTo4NjMzIgogIGMubWFuYWdlbWVudF9jb25zb2xlX3Bhc3N3b3JkID0gInNl\nY3JldCIKZW5kCm1hbmFnZW1lbnRfY29uc29sZV9jbGllbnQgPSBPY3Rva2l0\nLmVudGVycHJpc2VfbWFuYWdlbWVudF9jb25zb2xlX2NsaWVudApgYGAKCiMj\nIyBTU0wgQ29ubmVjdGlvbiBFcnJvcnMKCllvdSAqbWF5KiBuZWVkIHRvIGRp\nc2FibGUgU1NMIHRlbXBvcmFyaWx5IHdoaWxlIGZpcnN0IHNldHRpbmcgdXAg\neW91ciBHaXRIdWIgRW50ZXJwcmlzZSBpbnN0YWxsLiBZb3UgY2FuIGRvIHRo\nYXQgd2l0aCB0aGUgZm9sbG93aW5nIGNvbmZpZ3VyYXRpb246CgpgYGAgcnVi\neQpjbGllbnQuY29ubmVjdGlvbl9vcHRpb25zWzpzc2xdID0geyA6dmVyaWZ5\nID0+IGZhbHNlIH0KYGBgCgpEbyByZW1lbWJlciB0byB0dXJuIGA6dmVyaWZ5\nYCBiYWNrIHRvIGB0cnVlYCwgYXMgaXQncyBpbXBvcnRhbnQgZm9yIHNlY3Vy\nZSBjb21tdW5pY2F0aW9uLgoKIyMgQ29uZmlndXJhdGlvbiBhbmQgZGVmYXVs\ndHMKCldoaWxlIGBPY3Rva2l0OjpDbGllbnRgIGFjY2VwdHMgYSByYW5nZSBv\nZiBvcHRpb25zIHdoZW4gY3JlYXRpbmcgYSBuZXcgY2xpZW50Cmluc3RhbmNl\nLCBPY3Rva2l0J3MgY29uZmlndXJhdGlvbiBBUEkgYWxsb3dzIHlvdSB0byBz\nZXQgeW91ciBjb25maWd1cmF0aW9uCm9wdGlvbnMgYXQgdGhlIG1vZHVsZSBs\nZXZlbC4gVGhpcyBpcyBwYXJ0aWN1bGFybHkgaGFuZHkgaWYgeW91J3JlIGNy\nZWF0aW5nIGEKbnVtYmVyIG9mIGNsaWVudCBpbnN0YW5jZXMgYmFzZWQgb24g\nc29tZSBzaGFyZWQgZGVmYXVsdHMuIENoYW5naW5nIG9wdGlvbnMKYWZmZWN0\ncyBuZXcgaW5zdGFuY2VzIG9ubHkgYW5kIHdpbGwgbm90IG1vZGlmeSBleGlz\ndGluZyBgT2N0b2tpdDo6Q2xpZW50YAppbnN0YW5jZXMgY3JlYXRlZCB3aXRo\nIHByZXZpb3VzIG9wdGlvbnMuCgojIyMgQ29uZmlndXJpbmcgbW9kdWxlIGRl\nZmF1bHRzCgpFdmVyeSB3cml0YWJsZSBhdHRyaWJ1dGUgaW4ge09jdG9raXQ6\nOkNvbmZpZ3VyYWJsZX0gY2FuIGJlIHNldCBvbmUgYXQgYSB0aW1lOgoKYGBg\ncnVieQpPY3Rva2l0LmFwaV9lbmRwb2ludCA9ICdodHRwOi8vYXBpLmdpdGh1\nYi5kZXYnCk9jdG9raXQud2ViX2VuZHBvaW50ID0gJ2h0dHA6Ly9naXRodWIu\nZGV2JwpgYGAKCm9yIGluIGJhdGNoOgoKYGBgcnVieQpPY3Rva2l0LmNvbmZp\nZ3VyZSBkbyB8Y3wKICBjLmFwaV9lbmRwb2ludCA9ICdodHRwOi8vYXBpLmdp\ndGh1Yi5kZXYnCiAgYy53ZWJfZW5kcG9pbnQgPSAnaHR0cDovL2dpdGh1Yi5k\nZXYnCmVuZApgYGAKCiMjIyBVc2luZyBFTlYgdmFyaWFibGVzCgpEZWZhdWx0\nIGNvbmZpZ3VyYXRpb24gdmFsdWVzIGFyZSBzcGVjaWZpZWQgaW4ge09jdG9r\naXQ6OkRlZmF1bHR9LiBNYW55CmF0dHJpYnV0ZXMgd2lsbCBsb29rIGZvciBh\nIGRlZmF1bHQgdmFsdWUgZnJvbSB0aGUgRU5WIGJlZm9yZSByZXR1cm5pbmcK\nT2N0b2tpdCdzIGRlZmF1bHQuCgpgYGBydWJ5CiMgR2l2ZW4gJE9DVE9LSVRf\nQVBJX0VORFBPSU5UIGlzICJodHRwOi8vYXBpLmdpdGh1Yi5kZXYiCk9jdG9r\naXQuYXBpX2VuZHBvaW50CgojID0+ICJodHRwOi8vYXBpLmdpdGh1Yi5kZXYi\nCmBgYAoKRGVwcmVjYXRpb24gd2FybmluZ3MgYW5kIEFQSSBlbmRwb2ludHMg\naW4gZGV2ZWxvcG1lbnQgcHJldmlldyB3YXJuaW5ncyBhcmUKcHJpbnRlZCB0\nbyBTVERPVVQgYnkgZGVmYXVsdCwgdGhlc2UgY2FuIGJlIGRpc2FibGVkIGJ5\nIHNldHRpbmcgdGhlIEVOVgpgT0NUT0tJVF9TSUxFTlQ9dHJ1ZWAuCgojIyBI\neXBlcm1lZGlhIGFnZW50CgpTdGFydGluZyBpbiB2ZXJzaW9uIDIuMCwgT2N0\nb2tpdCBpcyBbaHlwZXJtZWRpYV1bXS1lbmFibGVkLiBVbmRlciB0aGUgaG9v\nZCwKe09jdG9raXQ6OkNsaWVudH0gdXNlcyBbU2F3eWVyXVtdLCBhIGh5cGVy\nbWVkaWEgY2xpZW50IGJ1aWx0IG9uIFtGYXJhZGF5XVtdLgoKIyMjIEh5cGVy\nbWVkaWEgaW4gT2N0b2tpdAoKUmVzb3VyY2VzIHJldHVybmVkIGJ5IE9jdG9r\naXQgbWV0aG9kcyBjb250YWluIG5vdCBvbmx5IGRhdGEgYnV0IGh5cGVybWVk\naWEKbGluayByZWxhdGlvbnM6CgpgYGBydWJ5CnVzZXIgPSBPY3Rva2l0LnVz\nZXIgJ3RlY2hub3dlZW5pZScKCiMgR2V0IHRoZSByZXBvcyByZWwsIHJldHVy\nbmVkIGZyb20gdGhlIEFQSQojIGFzIHJlcG9zX3VybCBpbiB0aGUgcmVzb3Vy\nY2UKdXNlci5yZWxzWzpyZXBvc10uaHJlZgojID0+ICJodHRwczovL2FwaS5n\naXRodWIuY29tL3VzZXJzL3RlY2hub3dlZW5pZS9yZXBvcyIKCnJlcG9zID0g\ndXNlci5yZWxzWzpyZXBvc10uZ2V0LmRhdGEKcmVwb3MubGFzdC5uYW1lCiMg\nPT4gImZhcmFkYXktemVyb21xIgpgYGAKCldoZW4gcHJvY2Vzc2luZyBBUEkg\ncmVzcG9uc2VzLCBhbGwgYCpfdXJsYCBhdHRyaWJ1dGVzIGFyZSBjdWxsZWQg\naW4gdG8gdGhlIGxpbmsKcmVsYXRpb25zIGNvbGxlY3Rpb24uIEFueSBgdXJs\nYCBhdHRyaWJ1dGUgYmVjb21lcyBgLnJlbHNbOnNlbGZdYC4KCiMjIyBVUkkg\ndGVtcGxhdGVzCgpZb3UgbWlnaHQgbm90aWNlIG1hbnkgbGluayByZWxhdGlv\nbnMgaGF2ZSB2YXJpYWJsZSBwbGFjZWhvbGRlcnMuIE9jdG9raXQKc3VwcG9y\ndHMgW1VSSSBUZW1wbGF0ZXNdW3VyaS10ZW1wbGF0ZXNdIGZvciBwYXJhbWV0\nZXJpemVkIFVSSSBleHBhbnNpb246CgpgYGBydWJ5CnJlcG8gPSBPY3Rva2l0\nLnJlcG8gJ3Blbmd3eW5uL3Bpbmd3eW5uJwpyZWwgPSByZXBvLnJlbHNbOmlz\nc3Vlc10KIyA9PiAjPFNhd3llcjo6UmVsYXRpb246IGlzc3VlczogZ2V0IGh0\ndHBzOi8vYXBpLmdpdGh1Yi5jb20vcmVwb3MvcGVuZ3d5bm4vcGluZ3d5bm4v\naXNzdWVzey9udW1iZXJ9PgoKIyBHZXQgYSBwYWdlIG9mIGlzc3VlcwpyZWwu\nZ2V0LmRhdGEKCiMgR2V0IGlzc3VlICMyCnJlbC5nZXQoOnVyaSA9PiB7Om51\nbWJlciA9PiAyfSkuZGF0YQpgYGAKCiMjIyBUaGUgRnVsbCBIeXBlcm1lZGlh\nIEV4cGVyaWVuY2XihKIKCklmIHlvdSB3YW50IHRvIHVzZSBPY3Rva2l0IGFz\nIGEgcHVyZSBoeXBlcm1lZGlhIEFQSSBjbGllbnQsIHlvdSBjYW4gc3RhcnQg\nYXQKdGhlIEFQSSByb290IGFuZCBmb2xsb3cgbGluayByZWxhdGlvbnMgZnJv\nbSB0aGVyZToKCmBgYHJ1YnkKcm9vdCA9IE9jdG9raXQucm9vdApyb290LnJl\nbHNbOnJlcG9zaXRvcnldLmdldCA6dXJpID0+IHs6b3duZXIgPT4gIm9jdG9r\naXQiLCA6cmVwbyA9PiAib2N0b2tpdC5yYiIgfQpyb290LnJlbHNbOnVzZXJf\ncmVwb3NpdG9yaWVzXS5nZXQgOnVyaSA9PiB7IDp1c2VyID0+ICJvY3Rva2l0\nIiB9LAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgOnF1ZXJ5\nID0+IHsgOnR5cGUgPT4gIm93bmVyIiB9CmBgYAoKT2N0b2tpdCAzLjAgYWlt\ncyB0byBiZSBoeXBlcm1lZGlhLWRyaXZlbiwgcmVtb3ZpbmcgdGhlIGludGVy\nbmFsIFVSTApjb25zdHJ1Y3Rpb24gY3VycmVudGx5IHVzZWQgdGhyb3VnaG91\ndCB0aGUgY2xpZW50LgoKW2h5cGVybWVkaWFdOiBodHRwOi8vZW4ud2lraXBl\nZGlhLm9yZy93aWtpL0h5cGVybWVkaWEKW1Nhd3llcl06IGh0dHBzOi8vZ2l0\naHViLmNvbS9sb3N0aXNsYW5kL3Nhd3llcgpbRmFyYWRheV06IGh0dHBzOi8v\nZ2l0aHViLmNvbS9sb3N0aXNsYW5kL2ZhcmFkYXkKW3VyaS10ZW1wbGF0ZXNd\nOiBodHRwOi8vdG9vbHMuaWV0Zi5vcmcvaHRtbC9yZmM2NTcwCgojIyBVcGdy\nYWRpbmcgZ3VpZGUKClZlcnNpb24gNC4wCgotICoqcmVtb3ZlcyBzdXBwb3J0\nIGZvciBhIFtsb25nLWRlcHJlY2F0ZWQgb3ZlcmxvYWRdW2xpc3QtcHVsbHNd\nIGZvcgpwYXNzaW5nIHN0YXRlIGFzIGEgcG9zaXRpb25hbCBhcmd1bWVudCoq\nIHdoZW4gbGlzdGluZyBwdWxsIHJlcXVlc3RzLiBJbnN0ZWFkLApwYXNzIGBz\ndGF0ZWAgaW4gdGhlIG1ldGhvZCBvcHRpb25zLgotICoqZHJvcHMgc3VwcG9y\ndCBmb3IgUnVieSA8IDIuMCoqLgotIGFkZHMgc3VwcG9ydCBmb3IgbmV3IFtF\nbnRlcnByaXNlLW9ubHkgQVBJc10oI3dvcmtpbmctd2l0aC1naXRodWItZW50\nZXJwcmlzZSkuCi0gYWRkcyBzdXBwb3J0IGZvciBbUmVwb3NpdG9yeSByZWRp\ncmVjdHNdW3JlZGlyZWN0c10uCgpbbGlzdC1wdWxsc106IGh0dHBzOi8vZ2l0\naHViLmNvbS9vY3Rva2l0L29jdG9raXQucmIvY29tbWl0L2U0OGU5MWY3MzZk\nNWZjZTUxZTNiZjc0ZDdjOTAyMmFhYTUyZjVjNWMKW3JlZGlyZWN0c106IGh0\ndHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vY2hhbmdlcy8yMDE1LTA1LTI2\nLXJlcG9zaXRvcnktcmVkaXJlY3RzLWFyZS1jb21pbmcvCgpWZXJzaW9uIDMu\nMCBpbmNsdWRlcyBhIGNvdXBsZSBicmVha2luZyBjaGFuZ2VzIHdoZW4gdXBn\ncmFkaW5nIGZyb20gdjIueC54OgoKVGhlIFtkZWZhdWx0IG1lZGlhIHR5cGVd\nW2RlZmF1bHQtbWVkaWEtdHlwZV0gaXMgbm93IGB2M2AgaW5zdGVhZCBvZiBg\nYmV0YWAuIElmCnlvdSBuZWVkIHRvIHJlcXVlc3QgdGhlIG9sZGVyIG1lZGlh\nIHR5cGUsIHlvdSBjYW4gc2V0IHRoZSBkZWZhdWx0IG1lZGlhIHR5cGUKZm9y\nIHRoZSBjbGllbnQ6CgpgYGBydWJ5Ck9jdG9raXQuZGVmYXVsdF9tZWRpYV90\neXBlID0gImFwcGxpY2F0aW9uL3ZuZC5naXRodWIuYmV0YStqc29uIgpgYGAK\nb3IgcGVyLXJlcXVlc3QKCmBgYHJ1YnkKT2N0b2tpdC5lbWFpbHMoOmFjY2Vw\ndCA9PiAiYXBwbGljYXRpb24vdm5kLmdpdGh1Yi5iZXRhK2pzb24iKQpgYGAK\nClRoZSBsb25nLWRlcHJlY2F0ZWQgYE9jdG9raXQ6OkNsaWVudCNjcmVhdGVf\nZG93bmxvYWRgIG1ldGhvZCBoYXMgYmVlbiByZW1vdmVkLgoKW2RlZmF1bHQt\nbWVkaWEtdHlwZV06IGh0dHBzOi8vZGV2ZWxvcGVyLmdpdGh1Yi5jb20vY2hh\nbmdlcy8yMDE0LTAxLTA3LXVwY29taW5nLWNoYW5nZS10by1kZWZhdWx0LW1l\nZGlhLXR5cGUvCgojIyMgVXBncmFkaW5nIGZyb20gMS54LngKClZlcnNpb24g\nMi4wIGluY2x1ZGVzIGEgY29tcGxldGVseSByZXdyaXR0ZW4gYENsaWVudGAg\nZmFjdG9yeSB0aGF0IG5vdyBtZW1vaXplcwpjbGllbnQgaW5zdGFuY2VzIGJh\nc2VkIG9uIHVuaXF1ZSBjb25maWd1cmF0aW9uIG9wdGlvbnMuIEJyZWFraW5n\nIGNoYW5nZXMgYWxzbwppbmNsdWRlOgoKKiBgOm9hdXRoX3Rva2VuYCBpcyBu\nb3cgYDphY2Nlc3NfdG9rZW5gCiogYDphdXRvX3RyYXZlcnNhbGAgaXMgbm93\nIGA6YXV0b19wYWdpbmF0ZWAKKiBgSGFzaGllOjpNYXNoYCBoYXMgYmVlbiBy\nZW1vdmVkLiBSZXNwb25zZXMgbm93IHJldHVybiBhIGBTYXd5ZXI6OlJlc291\ncmNlYAogIG9iamVjdC4gVGhpcyBuZXcgdHlwZSBiZWhhdmVzIG1vc3RseSBs\naWtlIGEgUnVieSBgSGFzaGAsIGJ1dCBkb2VzIG5vdCBmdWxseQogIHN1cHBv\ncnQgdGhlIGBIYXNoaWU6Ok1hc2hgIEFQSS4KKiBUd28gbmV3IGNsaWVudCBl\ncnJvciB0eXBlcyBhcmUgcmFpc2VkIHdoZXJlIGFwcHJvcHJpYXRlOgogIGBP\nY3Rva2l0OjpUb29NYW55UmVxdWVzdHNgIGFuZCBgT2N0b2tpdDo6VG9vTWFu\neUxvZ2luQXR0ZW1wdHNgCiogVGhlIGBzZWFyY2hfKmAgbWV0aG9kcyBmcm9t\nIHYxLnggYXJlIG5vdyBmb3VuZCBhdCBgbGVnYWN5X3NlYXJjaF8qYAoqIFN1\ncHBvcnQgZm9yIG5ldHJjIHJlcXVpcmVzIGluY2x1ZGluZyB0aGUgW25ldHJj\nIGdlbV1bXSBpbiB5b3VyIEdlbWZpbGUgb3IKICBnZW1zcGVjLgoqIERhdGVU\naW1lIGZpZWxkcyBhcmUgbm93IHByb3BlciBgRGF0ZVRpbWVgIG9iamVjdHMu\nIFByZXZpb3VzIHZlcnNpb25zIG91dHB1dHRlZCBEYXRlVGltZSBmaWVsZHMg\nYXMgJ1N0cmluZycgb2JqZWN0cy4KCltuZXRyYyBnZW1dOiBodHRwczovL3J1\nYnlnZW1zLm9yZy9nZW1zL25ldHJjCgoKIyMgQWR2YW5jZWQgdXNhZ2UKClNp\nbmNlIE9jdG9raXQgZW1wbG95cyBbRmFyYWRheV1bZmFyYWRheV0gdW5kZXIg\ndGhlIGhvb2QsIHNvbWUgYmVoYXZpb3IgY2FuIGJlCmV4dGVuZGVkIHZpYSBt\naWRkbGV3YXJlLgoKIyMjIERlYnVnZ2luZwoKT2Z0ZW4sIGl0IGhlbHBzIHRv\nIGtub3cgd2hhdCBPY3Rva2l0IGlzIGRvaW5nIHVuZGVyIHRoZSBob29kLiBZ\nb3UgY2FuIGFkZCBhCmxvZ2dlciB0byB0aGUgbWlkZGxld2FyZSB0aGF0IGVu\nYWJsZXMgeW91IHRvIHBlZWsgaW50byB0aGUgdW5kZXJseWluZyBIVFRQCnRy\nYWZmaWM6CgpgYGBydWJ5CnN0YWNrID0gRmFyYWRheTo6UmFja0J1aWxkZXIu\nbmV3IGRvIHxidWlsZGVyfAogIGJ1aWxkZXIudXNlIE9jdG9raXQ6Ok1pZGRs\nZXdhcmU6OkZvbGxvd1JlZGlyZWN0cwogIGJ1aWxkZXIudXNlIE9jdG9raXQ6\nOlJlc3BvbnNlOjpSYWlzZUVycm9yCiAgYnVpbGRlci51c2UgT2N0b2tpdDo6\nUmVzcG9uc2U6OkZlZWRQYXJzZXIKICBidWlsZGVyLnJlc3BvbnNlIDpsb2dn\nZXIKICBidWlsZGVyLmFkYXB0ZXIgRmFyYWRheS5kZWZhdWx0X2FkYXB0ZXIK\nZW5kCk9jdG9raXQubWlkZGxld2FyZSA9IHN0YWNrCk9jdG9raXQudXNlciAn\ncGVuZ3d5bm4nCmBgYApgYGAKSSwgWzIwMTMtMDgtMjJUMTU6NTQ6MzguNTgz\nMzAwICM4ODIyN10gIElORk8gLS0gOiBnZXQgaHR0cHM6Ly9hcGkuZ2l0aHVi\nLmNvbS91c2Vycy9wZW5nd3lubgpELCBbMjAxMy0wOC0yMlQxNTo1NDozOC41\nODM0MDEgIzg4MjI3XSBERUJVRyAtLSByZXF1ZXN0OiBBY2NlcHQ6ICJhcHBs\naWNhdGlvbi92bmQuZ2l0aHViLmJldGEranNvbiIKVXNlci1BZ2VudDogIk9j\ndG9raXQgUnVieSBHZW0gMi4wLjAucmM0IgpJLCBbMjAxMy0wOC0yMlQxNTo1\nNDozOC44NDMzMTMgIzg4MjI3XSAgSU5GTyAtLSBTdGF0dXM6IDIwMApELCBb\nMjAxMy0wOC0yMlQxNTo1NDozOC44NDM0NTkgIzg4MjI3XSBERUJVRyAtLSBy\nZXNwb25zZTogc2VydmVyOiAiR2l0SHViLmNvbSIKZGF0ZTogIlRodSwgMjIg\nQXVnIDIwMTMgMjA6NTQ6NDAgR01UIgpjb250ZW50LXR5cGU6ICJhcHBsaWNh\ndGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04Igp0cmFuc2Zlci1lbmNvZGluZzog\nImNodW5rZWQiCmNvbm5lY3Rpb246ICJjbG9zZSIKc3RhdHVzOiAiMjAwIE9L\nIgp4LXJhdGVsaW1pdC1saW1pdDogIjYwIgp4LXJhdGVsaW1pdC1yZW1haW5p\nbmc6ICIzOSIKeC1yYXRlbGltaXQtcmVzZXQ6ICIxMzc3MjA1NDQzIgouLi4K\nYGBgCgpTZWUgdGhlIFtGYXJhZGF5IFJFQURNRV1bZmFyYWRheV0gZm9yIG1v\ncmUgbWlkZGxld2FyZSBtYWdpYy4KCiMjIyBDYWNoaW5nCgpJZiB5b3Ugd2Fu\ndCB0byBib29zdCBwZXJmb3JtYW5jZSwgc3RyZXRjaCB5b3VyIEFQSSByYXRl\nIGxpbWl0LCBvciBhdm9pZCBwYXlpbmcKdGhlIGh5cGVybWVkaWEgdGF4LCB5\nb3UgY2FuIHVzZSBbRmFyYWRheSBIdHRwIENhY2hlXVtjYWNoZV0uCgpBZGQg\ndGhlIGdlbSB0byB5b3VyIEdlbWZpbGUKCiAgICBnZW0gJ2ZhcmFkYXktaHR0\ncC1jYWNoZScKCk5leHQsIGNvbnN0cnVjdCB5b3VyIG93biBGYXJhZGF5IG1p\nZGRsZXdhcmU6CgpgYGBydWJ5CnN0YWNrID0gRmFyYWRheTo6UmFja0J1aWxk\nZXIubmV3IGRvIHxidWlsZGVyfAogIGJ1aWxkZXIudXNlIEZhcmFkYXk6Okh0\ndHBDYWNoZSwgc2VyaWFsaXplcjogTWFyc2hhbCwgc2hhcmVkX2NhY2hlOiBm\nYWxzZQogIGJ1aWxkZXIudXNlIE9jdG9raXQ6OlJlc3BvbnNlOjpSYWlzZUVy\ncm9yCiAgYnVpbGRlci5hZGFwdGVyIEZhcmFkYXkuZGVmYXVsdF9hZGFwdGVy\nCmVuZApPY3Rva2l0Lm1pZGRsZXdhcmUgPSBzdGFjawpgYGAKCk9uY2UgY29u\nZmlndXJlZCwgdGhlIG1pZGRsZXdhcmUgd2lsbCBzdG9yZSByZXNwb25zZXMg\naW4gY2FjaGUgYmFzZWQgb24gRVRhZwpmaW5nZXJwcmludCBhbmQgc2VydmUg\ndGhvc2UgYmFjayB1cCBmb3IgZnV0dXJlIGAzMDRgIHJlc3BvbnNlcyBmb3Ig\ndGhlIHNhbWUKcmVzb3VyY2UuIFNlZSB0aGUgW3Byb2plY3QgUkVBRE1FXVtj\nYWNoZV0gZm9yIGFkdmFuY2VkIHVzYWdlLgoKCltjYWNoZV06IGh0dHBzOi8v\nZ2l0aHViLmNvbS9wbGF0YWZvcm1hdGVjL2ZhcmFkYXktaHR0cC1jYWNoZQpb\nZmFyYWRheV06IGh0dHBzOi8vZ2l0aHViLmNvbS9sb3N0aXNsYW5kL2ZhcmFk\nYXkKCiMjIEhhY2tpbmcgb24gT2N0b2tpdC5yYgoKSWYgeW91IHdhbnQgdG8g\naGFjayBvbiBPY3Rva2l0IGxvY2FsbHksIHdlIHRyeSB0byBtYWtlIFtib290\nc3RyYXBwaW5nIHRoZQpwcm9qZWN0XVtib290c3RyYXBwaW5nXSBhcyBwYWlu\nbGVzcyBhcyBwb3NzaWJsZS4gVG8gc3RhcnQgaGFja2luZywgY2xvbmUgYW5k\nIHJ1bjoKCiAgICBzY3JpcHQvYm9vdHN0cmFwCgpUaGlzIHdpbGwgaW5zdGFs\nbCBwcm9qZWN0IGRlcGVuZGVuY2llcyBhbmQgZ2V0IHlvdSB1cCBhbmQgcnVu\nbmluZy4gSWYgeW91IHdhbnQKdG8gcnVuIGEgUnVieSBjb25zb2xlIHRvIHBv\na2Ugb24gT2N0b2tpdCwgeW91IGNhbiBjcmFuayBvbmUgdXAgd2l0aDoKCiAg\nICBzY3JpcHQvY29uc29sZQoKVXNpbmcgdGhlIHNjcmlwdHMgaW4gYC4vc2Ny\naXB0c2AgaW5zdGVhZCBvZiBgYnVuZGxlIGV4ZWMgcnNwZWNgLCBgYnVuZGxl\nCmNvbnNvbGVgLCBldGMuICBlbnN1cmVzIHlvdXIgZGVwZW5kZW5jaWVzIGFy\nZSB1cC10by1kYXRlLgoKIyMjIFJ1bm5pbmcgYW5kIHdyaXRpbmcgbmV3IHRl\nc3RzCgpPY3Rva2l0IHVzZXMgW1ZDUl1bXSBmb3IgcmVjb3JkaW5nIGFuZCBw\nbGF5aW5nIGJhY2sgQVBJIGZpeHR1cmVzIGR1cmluZyB0ZXN0CnJ1bnMuIFRo\nZXNlIGNhc3NldHRlcyAoZml4dHVyZXMpIGFyZSBwYXJ0IG9mIHRoZSBHaXQg\ncHJvamVjdCBpbiB0aGUgYHNwZWMvY2Fzc2V0dGVzYApmb2xkZXIuIElmIHlv\ndSdyZSBub3QgcmVjb3JkaW5nIG5ldyBjYXNzZXR0ZXMgeW91IGNhbiBydW4g\ndGhlIHNwZWNzIHdpdGggZXhpc3RpbmcKY2Fzc2V0dGVzIHdpdGg6CgogICAg\nc2NyaXB0L3Rlc3QKCk9jdG9raXQgdXNlcyBlbnZpcm9ubWVudGFsIHZhcmlh\nYmxlcyBmb3Igc3RvcmluZyBjcmVkZW50aWFscyB1c2VkIGluIHRlc3Rpbmcu\nCklmIHlvdSBhcmUgdGVzdGluZyBhbiBBUEkgZW5kcG9pbnQgdGhhdCBkb2Vz\nbid0IHJlcXVpcmUgYXV0aGVudGljYXRpb24sIHlvdQpjYW4gZ2V0IGF3YXkg\nd2l0aG91dCBhbnkgYWRkaXRpb25hbCBjb25maWd1cmF0aW9uLiBGb3IgdGhl\nIG1vc3QgcGFydCwgdGVzdHMKdXNlIGFuIGF1dGhlbnRpY2F0ZWQgY2xpZW50\nLCB1c2luZyBhIHRva2VuIHN0b3JlZCBpbiBgRU5WWydPQ1RPS0lUX1RFU1Rf\nR0lUSFVCX1RPS0VOJ11gLgpUaGVyZSBhcmUgc2V2ZXJhbCBkaWZmZXJlbnQg\nYXV0aGVudGljYXRpbmcgbWV0aG9kJ3MgdXNlZCBhY3Jvc3MgdGhlIGFwaS4K\nSGVyZSBpcyB0aGUgZnVsbCBsaXN0IG9mIGNvbmZpZ3VyYWJsZSBlbnZpcm9u\nbWVudGFsIHZhcmlhYmxlcyBmb3IgdGVzdGluZwpPY3Rva2l0OgoKRU5WIFZh\ncmlhYmxlIHwgRGVzY3JpcHRpb24gfAo6LS0tLS0tLS0tLS0tLS0tLS0tLXw6\nLS0tLS0tLS0tLS0tLS0tLS18CmBPQ1RPS0lUX1RFU1RfR0lUSFVCX0xPR0lO\nYHwgR2l0SHViIGxvZ2luIG5hbWUgKHByZWZlcmFibHkgb25lIGNyZWF0ZWQg\nc3BlY2lmaWNhbGx5IGZvciB0ZXN0aW5nIGFnYWluc3QpLgpgT0NUT0tJVF9U\nRVNUX0dJVEhVQl9QQVNTV09SRGB8IFBhc3N3b3JkIGZvciB0aGUgdGVzdCBH\naXRIdWIgbG9naW4uCmBPQ1RPS0lUX1RFU1RfR0lUSFVCX1RPS0VOYCB8IFtQ\nZXJzb25hbCBBY2Nlc3MgVG9rZW5dKGh0dHBzOi8vZ2l0aHViLmNvbS9ibG9n\nLzE1MDktcGVyc29uYWwtYXBpLXRva2VucykgZm9yIHRoZSB0ZXN0IEdpdEh1\nYiBsb2dpbi4KYE9DVE9LSVRfVEVTVF9HSVRIVUJfQ0xJRU5UX0lEYCB8IFRl\nc3QgT0F1dGggYXBwbGljYXRpb24gY2xpZW50IGlkLgpgT0NUT0tJVF9URVNU\nX0dJVEhVQl9DTElFTlRfU0VDUkVUYCB8IFRlc3QgT0F1dGggYXBwbGljYXRp\nb24gY2xpZW50IHNlY3JldC4KYE9DVE9LSVRfVEVTVF9HSVRIVUJfUkVQT1NJ\nVE9SWWAgfCBUZXN0IHJlcG9zaXRvcnkgdG8gcGVyZm9ybSBkZXN0cnVjdGl2\nZSBhY3Rpb25zIGFnYWluc3QsIHRoaXMgc2hvdWxkIG5vdCBiZSBzZXQgdG8g\nYW55IHJlcG9zaXRvcnkgb2YgaW1wb3J0YW5jZS4gKipBdXRvbWF0aWNhbGx5\nIGNyZWF0ZWQgYnkgdGhlIHRlc3Qgc3VpdGUgaWYgbm9uZXhpc3RlbnQqKiBE\nZWZhdWx0OiBgYXBpLXNhbmRib3hgCmBPQ1RPS0lUX1RFU1RfR0lUSFVCX09S\nR0FOSVpBVElPTmAgfCBUZXN0IG9yZ2FuaXphdGlvbi4KYE9DVE9LSVRfVEVT\nVF9HSVRIVUJfRU5URVJQUklTRV9MT0dJTmAgfCBHaXRIdWIgRW50ZXJwcmlz\nZSBsb2dpbiBuYW1lLgpgT0NUT0tJVF9URVNUX0dJVEhVQl9FTlRFUlBSSVNF\nX1RPS0VOYCB8IEdpdEh1YiBFbnRlcnByaXNlIHRva2VuLgpgT0NUT0tJVF9U\nRVNUX0dJVEhVQl9FTlRFUlBSSVNFX01BTkFHRU1FTlRfQ09OU09MRV9QQVNT\nV09SRGAgfCBHaXRIdWIgRW50ZXJwcmlzZSBtYW5hZ2VtZW50IGNvbnNvbGUg\ncGFzc3dvcmQuCmBPQ1RPS0lUX1RFU1RfR0lUSFVCX0VOVEVSUFJJU0VfRU5E\nUE9JTlRgIHwgR2l0SHViIEVudGVycHJpc2UgaG9zdG5hbWUuCmBPQ1RPS0lU\nX1RFU1RfR0lUSFVCX0VOVEVSUFJJU0VfTUFOQUdFTUVOVF9DT05TT0xFX0VO\nRFBPSU5UYCB8IEdpdEh1YiBFbnRlcnByaXNlIE1hbmFnZW1lbnQgQ29uc29s\nZSBlbmRwb2ludC4KYE9DVE9LSVRfVEVTVF9HSVRIVUJfSU5URUdSQVRJT05g\nIHwgW0dpdEh1YiBJbnRlZ3JhdGlvbl0oaHR0cHM6Ly9kZXZlbG9wZXIuZ2l0\naHViLmNvbS9lYXJseS1hY2Nlc3MvaW50ZWdyYXRpb25zLykgb3duZWQgYnkg\neW91ciB0ZXN0IG9yZ2FuaXphdGlvbi4KYE9DVE9LSVRfVEVTVF9HSVRIVUJf\nSU5URUdSQVRJT05fSU5TVEFMTEFUSU9OYCB8IEluc3RhbGxhdGlvbiBvZiB0\naGUgR2l0SHViIEludGVncmF0aW9uIHNwZWNpZmllZCBhYm92ZS4KYE9DVE9L\nSVRfVEVTVF9JTlRFR1JBVElPTl9QRU1fS0VZYCB8IEZpbGUgcGF0aCB0byB0\naGUgcHJpdmF0ZSBrZXkgZ2VuZXJhdGVkIGZyb20geW91ciBpbnRlZ3JhdGlv\nbi4KClNpbmNlIHdlIHBlcmlvZGljYWxseSByZWZyZXNoIG91ciBjYXNzZXR0\nZXMsIHBsZWFzZSBrZWVwIHNvbWUgcG9pbnRzIGluIG1pbmQKd2hlbiB3cml0\naW5nIG5ldyBzcGVjcy4KCiogKipTcGVjcyBzaG91bGQgYmUgaWRlbXBvdGVu\ndCoqLiBUaGUgSFRUUCBjYWxscyBtYWRlIGR1cmluZyBhIHNwZWMgc2hvdWxk\nIGJlCiAgYWJsZSB0byBiZSBydW4gb3ZlciBhbmQgb3Zlci4gVGhpcyBtZWFu\ncyBkZWxldGluZyBhIGtub3duIHJlc291cmNlIHByaW9yIHRvCiAgY3JlYXRp\nbmcgaXQgaWYgdGhlIG5hbWUgaGFzIHRvIGJlIHVuaXF1ZS4KKiAqKlNwZWNz\nIHNob3VsZCBiZSBhYmxlIHRvIGJlIHJ1biBpbiByYW5kb20gb3JkZXIuKiog\nSWYgYSBzcGVjIGRlcGVuZHMgb24KICBhbm90aGVyIHJlc291cmNlIGFzIGEg\nZml4dHVyZSwgbWFrZSBzdXJlIHRoYXQncyBjcmVhdGVkIGluIHRoZSBzY29w\nZSBvZiB0aGUKICBzcGVjIGFuZCBub3QgZGVwZW5kIG9uIGEgcHJldmlvdXMg\nc3BlYyB0byBjcmVhdGUgdGhlIGRhdGEgbmVlZGVkLgoqICoqRG8gbm90IGRl\ncGVuZCBvbiBhdXRoZW50aWNhdGVkIHVzZXIgaW5mby4qKiBJbnN0ZWFkIG9m\nIGFzc2VydGluZwogIGFjdHVhbCB2YWx1ZXMgaW4gcmVzb3VyY2VzLCB0cnkg\ndG8gYXNzZXJ0IHRoZSBleGlzdGVuY2Ugb2YgYSBrZXkgb3IgdGhhdCBhCiAg\ncmVzcG9uc2UgaXMgYW4gQXJyYXkuIFdlJ3JlIHRlc3RpbmcgdGhlIGNsaWVu\ndCwgbm90IHRoZSBBUEkuCgpbYm9vdHN0cmFwcGluZ106IGh0dHA6Ly93eW5u\nbmV0aGVybGFuZC5jb20vbGlua2VkLzIwMTMwMTI4MDEvYm9vdHN0cmFwcGlu\nZy1jb25zaXN0ZW5jeQpbVkNSXTogaHR0cHM6Ly9naXRodWIuY29tL3Zjci92\nY3IKCiMjIFN1cHBvcnRlZCBSdWJ5IFZlcnNpb25zCgpUaGlzIGxpYnJhcnkg\nYWltcyB0byBzdXBwb3J0IGFuZCBpcyBbdGVzdGVkIGFnYWluc3RdW3RyYXZp\nc10gdGhlIGZvbGxvd2luZyBSdWJ5CmltcGxlbWVudGF0aW9uczoKCiogUnVi\neSAyLjAKKiBSdWJ5IDIuMQoqIFJ1YnkgMi4yCiogUnVieSAyLjMKKiBSdWJ5\nIDIuNAoKSWYgc29tZXRoaW5nIGRvZXNuJ3Qgd29yayBvbiBvbmUgb2YgdGhl\nc2UgUnVieSB2ZXJzaW9ucywgaXQncyBhIGJ1Zy4KClRoaXMgbGlicmFyeSBt\nYXkgaW5hZHZlcnRlbnRseSB3b3JrIChvciBzZWVtIHRvIHdvcmspIG9uIG90\naGVyIFJ1YnkKaW1wbGVtZW50YXRpb25zLCBidXQgc3VwcG9ydCB3aWxsIG9u\nbHkgYmUgcHJvdmlkZWQgZm9yIHRoZSB2ZXJzaW9ucyBsaXN0ZWQKYWJvdmUu\nCgpJZiB5b3Ugd291bGQgbGlrZSB0aGlzIGxpYnJhcnkgdG8gc3VwcG9ydCBh\nbm90aGVyIFJ1YnkgdmVyc2lvbiwgeW91IG1heQp2b2x1bnRlZXIgdG8gYmUg\nYSBtYWludGFpbmVyLiBCZWluZyBhIG1haW50YWluZXIgZW50YWlscyBtYWtp\nbmcgc3VyZSBhbGwgdGVzdHMKcnVuIGFuZCBwYXNzIG9uIHRoYXQgaW1wbGVt\nZW50YXRpb24uIFdoZW4gc29tZXRoaW5nIGJyZWFrcyBvbiB5b3VyCmltcGxl\nbWVudGF0aW9uLCB5b3Ugd2lsbCBiZSByZXNwb25zaWJsZSBmb3IgcHJvdmlk\naW5nIHBhdGNoZXMgaW4gYSB0aW1lbHkKZmFzaGlvbi4gSWYgY3JpdGljYWwg\naXNzdWVzIGZvciBhIHBhcnRpY3VsYXIgaW1wbGVtZW50YXRpb24gZXhpc3Qg\nYXQgdGhlIHRpbWUKb2YgYSBtYWpvciByZWxlYXNlLCBzdXBwb3J0IGZvciB0\naGF0IFJ1YnkgdmVyc2lvbiBtYXkgYmUgZHJvcHBlZC4KClt0cmF2aXNdOiBo\ndHRwczovL3RyYXZpcy1jaS5vcmcvb2N0b2tpdC9vY3Rva2l0LnJiCgojIyBW\nZXJzaW9uaW5nCgpUaGlzIGxpYnJhcnkgYWltcyB0byBhZGhlcmUgdG8gW1Nl\nbWFudGljIFZlcnNpb25pbmcgMi4wLjBdW3NlbXZlcl0uIFZpb2xhdGlvbnMK\nb2YgdGhpcyBzY2hlbWUgc2hvdWxkIGJlIHJlcG9ydGVkIGFzIGJ1Z3MuIFNw\nZWNpZmljYWxseSwgaWYgYSBtaW5vciBvciBwYXRjaAp2ZXJzaW9uIGlzIHJl\nbGVhc2VkIHRoYXQgYnJlYWtzIGJhY2t3YXJkIGNvbXBhdGliaWxpdHksIHRo\nYXQgdmVyc2lvbiBzaG91bGQgYmUKaW1tZWRpYXRlbHkgeWFua2VkIGFuZC9v\nciBhIG5ldyB2ZXJzaW9uIHNob3VsZCBiZSBpbW1lZGlhdGVseSByZWxlYXNl\nZCB0aGF0CnJlc3RvcmVzIGNvbXBhdGliaWxpdHkuIEJyZWFraW5nIGNoYW5n\nZXMgdG8gdGhlIHB1YmxpYyBBUEkgd2lsbCBvbmx5IGJlCmludHJvZHVjZWQg\nd2l0aCBuZXcgbWFqb3IgdmVyc2lvbnMuIEFzIGEgcmVzdWx0IG9mIHRoaXMg\ncG9saWN5LCB5b3UgY2FuIChhbmQKc2hvdWxkKSBzcGVjaWZ5IGEgZGVwZW5k\nZW5jeSBvbiB0aGlzIGdlbSB1c2luZyB0aGUgW1Blc3NpbWlzdGljIFZlcnNp\nb24KQ29uc3RyYWludF1bcHZjXSB3aXRoIHR3byBkaWdpdHMgb2YgcHJlY2lz\naW9uLiBGb3IgZXhhbXBsZToKCiAgICBzcGVjLmFkZF9kZXBlbmRlbmN5ICdv\nY3Rva2l0JywgJ34+IDMuMCcKClRoZSBjaGFuZ2VzIG1hZGUgYmV0d2VlbiB2\nZXJzaW9ucyBjYW4gYmUgc2VlbiBvbiB0aGUgW3Byb2plY3QgcmVsZWFzZXMg\ncGFnZV1bcmVsZWFzZXNdLgoKW3NlbXZlcl06IGh0dHA6Ly9zZW12ZXIub3Jn\nLwpbcHZjXTogaHR0cDovL2d1aWRlcy5ydWJ5Z2Vtcy5vcmcvcGF0dGVybnMv\nI3Blc3NpbWlzdGljLXZlcnNpb24tY29uc3RyYWludApbcmVsZWFzZXNdOiBo\ndHRwczovL2dpdGh1Yi5jb20vb2N0b2tpdC9vY3Rva2l0LnJiL3JlbGVhc2Vz\nCgojIyBMaWNlbnNlCgpDb3B5cmlnaHQgKGMpIDIwMDktMjAxNCBXeW5uIE5l\ndGhlcmxhbmQsIEFkYW0gU3RhY292aWFrLCBFcmlrIE1pY2hhZWxzLU9iZXIK\nClBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdl\nLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwphIGNvcHkgb2YgdGhpcyBzb2Z0\nd2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUK\nIlNvZnR3YXJlIiksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQg\ncmVzdHJpY3Rpb24sIGluY2x1ZGluZwp3aXRob3V0IGxpbWl0YXRpb24gdGhl\nIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gs\nCmRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBv\nZiB0aGUgU29mdHdhcmUsIGFuZCB0bwpwZXJtaXQgcGVyc29ucyB0byB3aG9t\nIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3Qg\ndG8KdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOgoKVGhlIGFib3ZlIGNvcHly\naWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwg\nYmUKaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0\naW9ucyBvZiB0aGUgU29mdHdhcmUuCgpUSEUgU09GVFdBUkUgSVMgUFJPVklE\nRUQgIkFTIElTIiwgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKRVhQ\nUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRP\nIFRIRSBXQVJSQU5USUVTIE9GCk1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBG\nT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5ECk5PTklORlJJTkdFTUVOVC4g\nSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhP\nTERFUlMgQkUKTElBQkxFIEZPUiBBTlkgQ0xBSU0sIERBTUFHRVMgT1IgT1RI\nRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTgpPRiBDT05UUkFD\nVCwgVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9S\nIElOIENPTk5FQ1RJT04KV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVTRSBP\nUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCg==\n".decodeMarkDown())
    }

    override fun createView(ui: AnkoContext<RepositoryActivity>) = with(ui) {
        coordinatorLayout {
            lparams(matchParent, matchParent)

            themedAppBarLayout(R.style.ThemeOverlay_AppCompat_Dark_ActionBar) {
                id = fabAnchorId
                lparams(matchParent, dip(300))
                collapsingToolbarLayout {
                    contentScrim = ColorDrawable(context.getContextColor(R.color.black))
                    expandedTitleMarginStart = dip(20)
                    expandedTitleMarginEnd = dip(20)
                    setExpandedTitleTextAppearance(R.style.SessionTitleExpanded)

                    frameLayout {
                        layoutParams = CollapsingToolbarLayout.LayoutParams(matchParent, matchParent).apply {
                            collapseMode = COLLAPSE_MODE_PARALLAX
                        }

                        headerImageView = imageView {
                            scaleType = ImageView.ScaleType.CENTER_CROP
                        }.lparams(matchParent, matchParent)

                        verticalLayout {
                            gravity = Gravity.CENTER_HORIZONTAL

                            userCircleImageView = circleImageView {
                                transitionName = "userImage"
                            }.lparams(dip(120), dip(120)) {
                                topMargin = dip(36)
                            }
                            fullNameTextView = textView {
                                textSize = 18F
                                textColor = context.getContextColor(R.color.white)
                            }.lparams(wrapContent, wrapContent)

                            descriptionTextView = textView {
                                textSize = 12F
                                maxLines = 2
                                textColor = context.getContextColor(R.color.white)
                            }.lparams(wrapContent, wrapContent) {
                                leftMargin = dip(32)
                                rightMargin = dip(32)
                            }

                            linearLayout {
                                lparams(wrapContent, wrapContent)

                                verticalLayout {
                                    lparams(wrapContent, wrapContent) { margin = dip(8) }
                                    gravity = Gravity.CENTER_HORIZONTAL

                                    watchCountTextView = textView {
                                        textSize = 32F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                    textView(R.string.watches) {
                                        textSize = 14F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                }

                                verticalLayout {
                                    lparams(wrapContent, wrapContent) { margin = dip(8) }
                                    gravity = Gravity.CENTER_HORIZONTAL

                                    starCountTextView = textView {
                                        textSize = 32F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                    textView(R.string.stars) {
                                        textSize = 14F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                }

                                verticalLayout {
                                    lparams(wrapContent, wrapContent) { margin = dip(8) }
                                    gravity = Gravity.CENTER_HORIZONTAL

                                    forkCountTextView = textView {
                                        textSize = 32F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                    textView(R.string.forks) {
                                        textSize = 14F
                                        textColor = context.getContextColor(R.color.white)
                                    }.lparams(wrapContent, wrapContent)
                                }
                            }
                        }
                    }

                    toolbar = toolbar {
                        title = ""
                        layoutParams = CollapsingToolbarLayout.LayoutParams(
                                matchParent,
                                dimen(context.getResourceId(R.attr.actionBarSize))
                        ).apply {
                            collapseMode = COLLAPSE_MODE_PIN
                        }
                    }
                }.lparams(width = matchParent, height = matchParent) {
                    scrollFlags = SCROLL_FLAG_SCROLL or SCROLL_FLAG_EXIT_UNTIL_COLLAPSED
                }
            }

            fab = floatingActionButton().lparams {
                anchorId = fabAnchorId
                anchorGravity = Gravity.BOTTOM or Gravity.END
                margin = dip(8)
            }

            nestedScrollView {
                markdownView = markdownView().lparams(matchParent, matchParent) {
                    leftMargin = dip(16)
                    rightMargin = dip(16)
                }
            }.lparams(matchParent, matchParent) {
                behavior = AppBarLayout.ScrollingViewBehavior()
            }
        }
    }
}